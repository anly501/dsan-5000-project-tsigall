[
  {
    "objectID": "decision_trees.html",
    "href": "decision_trees.html",
    "title": "Decision Trees",
    "section": "",
    "text": "Classification\n\n\nRegression"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Introduction",
    "section": "",
    "text": "Thomas Sigall - tns29\n\n\nDecision Making in Sports\nIn sports, as in all areas of life, there are a variety of decisions that actors can make as their game or competition unfolds. As a result, there are numerous decisions that can be made, each coming with their own level of risk. Some decisions are obvious, like tagging up from third base on a deep fly ball with less than two outs or punting on fourth and long when back at your own end zone. However, many more appear to not be so obvious, as evidenced by the variety of opinions that arise when observing these choices in action. Despite numerous advancements in analysis in many sports, decisions are still heavily debated on a daily basis. Even if analysis on other similar situations suggests one decision should be made, we often see the exact opposite on the field. Ward Edwards, in his 1954 paper “The theory of decision making” introduces this well, saying “The traditional mathematical notion for dealing with games of chance (and so with risky decisions) is the notion that choices should be made so as to maximize expected value… The assumption that people actually behave the way this mathematical notion says they should is contradicted by observable behavior in many risky situations” (Edwards 1954, 391).\nWhy do people behave this way? It goes against what we know about expected value and suggests that we are illogical actors. This is elaborated further by Daniel Kahneman and Amos Tversky in their influential 1979 paper “Prospect Theory: an Analysis of Decision Under Risk” in which they explain, “Choices among risky prospects exhibit several pervasive effects that are inconsistent with the basic tenets of utility theory” (Kahneman and Tversky 1979). This eventually leads them to an alternative theory of choice “in which value is assigned to gains and losses rather than to final assets and in which probabilities are replaced by decision weights” (Kahneman and Tversky 1979).\nTo better understand decision making, we will do as David Romer did in his 2006 paper “Do Firms Maximize? Evidence from Professional Football” (Romer 2006). We will look at one of the most decisions certainly in football but perhaps in all of sports: 4th down. Focusing on this decision and attempting to understand the reasoning behind why it is so frequently done incorrectly will hopefully allow us to learn more about the decision making process not only in football, but in many other areas of life.\n\n\nQuestions\n\nHow are decisions in sports currently evaluated?\nCould we improve this evaluation process?\nWould improvements in this process lead to better decision making on the field?\nHow can we determine why certain decisions are made?\nHow can we apply alternative theories of choice to specific games?\nHow different would the sports landscape look if everything were optimized?\nAre there certain factors that theories of choice could not take into account?\nIf there truly is an optimal choice every time, would it be possible for anyone to coach a team?\nCan these principles be exteneded to off-field deicisons, such as team-building and player evaluation?\nAre unoptimized decisions part of what makes sports enjoyable?\n\n\n\n\n\n\n\n\n\nReferences\n\nEdwards, Ward. 1954. “The Theory of Decision Making.” Psychological Bulletin 51 (4): 380–417. https://doi.org/10.1037/h0053870.\n\n\nKahneman, Daniel, and Amos Tversky. 1979. “Prospect Theory: An Analysis of Decision Under Risk.” Econometrica 47 (2): 263. https://doi.org/10.2307/1914185.\n\n\nRomer, David. 2006. “Do Firms Maximize? Evidence from Professional Football.” Journal of Political Economy 114 (2): 340–65. https://doi.org/10.1086/501171."
  },
  {
    "objectID": "code.html",
    "href": "code.html",
    "title": "Code",
    "section": "",
    "text": "Link to GitHub repository"
  },
  {
    "objectID": "data.html",
    "href": "data.html",
    "title": "Data",
    "section": "",
    "text": "A significant source of data was obtained using the nflreadr package. More information can be found here: Ho and Carl (2023).\n\n\n\n\nReferences\n\nHo, Tan, and Sebastian Carl. 2023. Nflreadr: Download ’Nflverse’ Data."
  },
  {
    "objectID": "introduction.html",
    "href": "introduction.html",
    "title": "Introduction",
    "section": "",
    "text": "Thomas Sigall - tns29\n\n\nDecision Making in Sports\nIn sports, as in all areas of life, there are a variety of decisions that actors can make as their game or competition unfolds. As a result, there are numerous decisions that can be made, each coming with their own level of risk. Some decisions are obvious, like tagging up from third base on a deep fly ball with less than two outs or punting on fourth and long when back at your own end zone. However, many more appear to not be so obvious, as evidenced by the variety of opinions that arise when observing these choices in action. Despite numerous advancements in analysis in many sports, decisions are still heavily debated on a daily basis. Even if analysis on other similar situations suggests one decision should be made, we often see the exact opposite on the field. Ward Edwards, in his 1954 paper “The theory of decision making” introduces this well, saying “The traditional mathematical notion for dealing with games of chance (and so with risky decisions) is the notion that choices should be made so as to maximize expected value… The assumption that people actually behave the way this mathematical notion says they should is contradicted by observable behavior in many risky situations” (Edwards 1954, 391).\nWhy do people behave this way? It goes against what we know about expected value and suggests that we are illogical actors. This is elaborated further by Daniel Kahneman and Amos Tversky in their influential 1979 paper “Prospect Theory: an Analysis of Decision Under Risk” in which they explain, “Choices among risky prospects exhibit several pervasive effects that are inconsistent with the basic tenets of utility theory” (Kahneman and Tversky 1979). This eventually leads them to an alternative theory of choice “in which value is assigned to gains and losses rather than to final assets and in which probabilities are replaced by decision weights” (Kahneman and Tversky 1979).\nTo better understand decision making, we will do as David Romer did in his 2006 paper “Do Firms Maximize? Evidence from Professional Football” (Romer 2006). We will look at one of the most decisions certainly in football but perhaps in all of sports: 4th down. Focusing on this decision and attempting to understand the reasoning behind why it is so frequently done incorrectly will hopefully allow us to learn more about the decision making process not only in football, but in many other areas of life.\n\n\nQuestions\n\nHow are decisions in sports currently evaluated?\nCould we improve this evaluation process?\nWould improvements in this process lead to better decision making on the field?\nHow can we determine why certain decisions are made?\nHow can we apply alternative theories of choice to specific games?\nHow different would the sports landscape look if everything were optimized?\nAre there certain factors that theories of choice could not take into account?\nIf there truly is an optimal choice every time, would it be possible for anyone to coach a team?\nCan these principles be exteneded to off-field deicisons, such as team-building and player evaluation?\nAre unoptimized decisions part of what makes sports enjoyable?\n\n\n\n\n\n\n\n\n\nReferences\n\nEdwards, Ward. 1954. “The Theory of Decision Making.” Psychological Bulletin 51 (4): 380–417. https://doi.org/10.1037/h0053870.\n\n\nKahneman, Daniel, and Amos Tversky. 1979. “Prospect Theory: An Analysis of Decision Under Risk.” Econometrica 47 (2): 263. https://doi.org/10.2307/1914185.\n\n\nRomer, David. 2006. “Do Firms Maximize? Evidence from Professional Football.” Journal of Political Economy 114 (2): 340–65. https://doi.org/10.1086/501171."
  },
  {
    "objectID": "data_cleaning.html",
    "href": "data_cleaning.html",
    "title": "Data Cleaning",
    "section": "",
    "text": "We start with the raw 4th down data from the nflverse package. The first six rows can be seen here.\n\n\n# A tibble: 6 × 383\n  play_id game_id      old_game_id home_team away_team season_type  week posteam\n    &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;  \n1       1 2022_01_BAL… 2022091107  NYJ       BAL       REG             1 &lt;NA&gt;   \n2      43 2022_01_BAL… 2022091107  NYJ       BAL       REG             1 NYJ    \n3      68 2022_01_BAL… 2022091107  NYJ       BAL       REG             1 NYJ    \n4      89 2022_01_BAL… 2022091107  NYJ       BAL       REG             1 NYJ    \n5     115 2022_01_BAL… 2022091107  NYJ       BAL       REG             1 NYJ    \n6     136 2022_01_BAL… 2022091107  NYJ       BAL       REG             1 NYJ    \n# ℹ 375 more variables: posteam_type &lt;chr&gt;, defteam &lt;chr&gt;, side_of_field &lt;chr&gt;,\n#   yardline_100 &lt;dbl&gt;, game_date &lt;chr&gt;, quarter_seconds_remaining &lt;dbl&gt;,\n#   half_seconds_remaining &lt;dbl&gt;, game_seconds_remaining &lt;dbl&gt;,\n#   game_half &lt;chr&gt;, quarter_end &lt;dbl&gt;, drive &lt;dbl&gt;, sp &lt;dbl&gt;, qtr &lt;dbl&gt;,\n#   down &lt;dbl&gt;, goal_to_go &lt;dbl&gt;, time &lt;chr&gt;, yrdln &lt;chr&gt;, ydstogo &lt;dbl&gt;,\n#   ydsnet &lt;dbl&gt;, desc &lt;chr&gt;, play_type &lt;chr&gt;, yards_gained &lt;dbl&gt;,\n#   shotgun &lt;dbl&gt;, no_huddle &lt;dbl&gt;, qb_dropback &lt;dbl&gt;, qb_kneel &lt;dbl&gt;, …\n\n\nThere are a large number of columns in this data, taken from the 2022 NFL season, we do not need all 383. The purpose of this data is to help determine how coaches today approach 4th down, a basic yet essential decision in the NFL. To do this we only need to look at these columns:\n\n\n# A tibble: 6 × 9\n  home_coach away_coach posteam_type ydstogo yardline_100 posteam go_boost    go\n  &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;\n1 Robert Sa… John Harb… home              15           64 NYJ       -3.45      0\n2 Robert Sa… John Harb… away               1           51 BAL        3.67      0\n3 Robert Sa… John Harb… home               9           82 NYJ       -2.07      0\n4 Robert Sa… John Harb… away               9           65 BAL       -1.01      0\n5 Robert Sa… John Harb… away               3            6 BAL        0.141     0\n6 Robert Sa… John Harb… home               1           66 NYJ        0.654     0\n# ℹ 1 more variable: epa &lt;dbl&gt;\n\n\nEach unit in this table is one 4th down decision. The variables include:\n\n\n\n\n\nVariable\nDefinition\n\n\n\n\nhome_coach\nHome Team Coach\n\n\naway_coach\nAway Team Coach\n\n\nposteam_type\nOffense Home or Away\n\n\nydstogo\nYards to Go\n\n\nyardline_100\nYardline Relative to End Zone\n\n\nposteam\nOffense Team\n\n\ngo_boost\nChange in Win Probability if Conversion Attempted\n\n\ngo\nConversion Attempted (T/F)\n\n\nepa\nEstimated Points Added as a Result of the Play\n\n\n\n\n\n\n\nMaking a table showing when coaches make the correct decisions on 4th down is essential in evaluating their decision making process. This is made easy by the inclusion of the go_boost variable, which tells us the change in win probability if the team decides to go for it.\n\n\n# A tibble: 6 × 5\n  coach          should_go shouldnt_go      EPA count\n  &lt;chr&gt;              &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt; &lt;int&gt;\n1 Andy Reid          0.216       0.982  0.0590    106\n2 Arthur Smith       0.333       0.985 -0.0540    114\n3 Bill Belichick     0.204       0.962 -0.221     128\n4 Brandon Staley     0.347       0.971 -0.00908   140\n5 Brian Daboll       0.361       0.949  0.159     139\n6 Dan Campbell       0.507       0.907 -0.00432   121\n\n\nThis data shows when coaches make the correct choice on 4th down, their average estimated points added on 4th downs throughout the season, and the number of 4th down decisions they had to make throughout the season. It shows the percent of times each coach makes the correct decision in two scenarios: when going for it would have a positive effect on their win probability and when going for it would have a negative effect on their win probability.\n\n\n\nOne of, if not the most important factor in making a decision on fourth down is the position your team is on the field. Looking at this more closely requires a table that shows coaches decisions based on where they are on the field and how many downs they need to gain to get a first down.\n\n\n`summarise()` has grouped output by 'yardline_100'. You can override using the\n`.groups` argument.\n\n\n# A tibble: 6 × 6\n# Groups:   yardline_100 [3]\n  yardline_100 ydstogo    go count go_boost increase_odds\n         &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt;         &lt;dbl&gt;\n1            1       1  80.5    41    7.06              1\n2            2       1  75       4    3.69              1\n3            2       2  40.7    27    2.89              1\n4            3       1  50       2    2.54              1\n5            3       2  16.7     6    0.995             1\n6            3       3  38.5    26    0.721             1\n\n\nThis table shows us the percentage of times a coach chose to go for it in the given situation. The first row, for example, shows that 80.5% of the time a coach decided to go for it when they were at 4th and 1 at the 1 yard line - they were 1 yard away from scoring. It also shows is the average increase in win probability if a coach were to go for it. For example, at 4th and 1 at the 1 yard line, going for it increases your win probability by an average of 7%, an incredibly large number.\n\n\n\n\nThe NFL subreddit is a useful place to extract text data produced by fans and their reaction to these essential decisions. Like most jobs, the goal of an NFL head coach is not only to win games, but to keep their bosses happy. The size and outspoken nature of NFL fan bases can be a factor in the job security of these coaches, as if a coach loses the fans, their job gets a lot harder. This is where sentiment analysis comes in, as getting an idea of how fans feel about 4th down decisions by certain coaches may give us insights into how they are making their decisions, and whether or not the fans have any influence on the decision making process.\nThis allows us to get posts from the NFL subreddit using a search query of “4th down” and access the comments of those posts.\n\nsubreddit = reddit.subreddit(\"nfl\")\nquery = \"4th down\"\n\ntop_posts = subreddit.search(query, limit=100)\nurls = []\ncorpus = []\n\nfor post in top_posts:\n    urls.append(post.permalink)\n    \nurl = \"https://www.reddit.com\" + urls[0]\n\nsubmission = reddit.submission(url=url)\n\nsubmission.comments.replace_more(limit=0)\n\n[]\n\nfor top_level_comment in submission.comments:\n    corpus.append(top_level_comment.body)\n\nvectorizer=CountVectorizer()\nXs = vectorizer.fit_transform(corpus)\n\ncol_names=vectorizer.get_feature_names_out()\n\nThe overall sentiment from this brief analysis is a positive one, but the search terms need to be more specific to get any useful information out of this process.\n\nfrom nltk.sentiment import SentimentIntensityAnalyzer\n\noverall = []\nsia = SentimentIntensityAnalyzer()\n\nfor text in corpus:\n  score=sia.polarity_scores(text)\n  overall.append(score['compound'])\n\n\n\nsum(overall)/len(overall)\n\n0.1513641304347826"
  },
  {
    "objectID": "data_exploration.html",
    "href": "data_exploration.html",
    "title": "4th Down Decisions",
    "section": "",
    "text": "We will initially explore the data in a similar manner to the method seen in David Romer’s paper (Romer 2006). In his evaluation of fourth down decisions, he followed a four step process. First, he estimated the value of kicking (not going for it). Second, he estimated the value of going for it. Third, he figured out which decision was better. Finally, he compared this to the actual decisions made by coaches.\nThanks again to the nflverse package, we already have completed steps one and two as we can simply use the go_boost variable to estimate the value of kicking or going for it on each fourth down. Step three was already completed in the cleaning process, as we already have a table that takes into account the fact that if go_boost is negative, then the offensive team should kick. If go_boost is positive, then they should go for it. We have all the information to evaluate theoretical decisions, now we must evaluate the actual decisions made by coaches.\n\n4th Down Statistics\nHow often do coaches make the correct decision on 4th down?\n\n\n\n\n\nWe can see a clear difference between these two plots when they are put on the same scale. When it would be a “correct” decision to kick rather than go for it (when win probability would go down if a conversion was attempted) coaches often make the correct decision. Every coach was correct in these situations at least 90% which makes sense because these decisions are often easy to make. They are not the borderline decisions that we can learn a lot about coaches from. For those we turn to the first graph, where we can clearly see that the decision on whether or not to go for it when doing so would increase your win probability is much more difficult, as only two coaches got this one right over 50% of the time. Let’s look at this decision more closely and see what turns coaches away from going for it even when they should be.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThe first graph is colored based on the proportion of plays in which a coach decides to go for it when doing so would have a positive impact on their win probability. The second graph is colored based on the proportion of plays in which going for it would have a positive impact on their win probability, regardless of whether or not a coach actually decided to go for it.\nThese graphs clearly show that coaches in the NFL are far too conservative. The only situation in which they consistently go for it is on 4th and 1 inside the 50. The data suggest that they should actually always go for it when there are less than 2 yards to go and almost always go for it within 5 yards. Coaches are consistently far too conservative in situations when it is clearly advantageous to attempt a 4th down conversion. Why might this be the case? Let’s perform some EDA to come up with some possible explanations.\n\n\n\n\n\nReferences\n\nRomer, David. 2006. “Do Firms Maximize? Evidence from Professional Football.” Journal of Political Economy 114 (2): 340–65. https://doi.org/10.1086/501171."
  },
  {
    "objectID": "data_cleaning.html#th-down-data",
    "href": "data_cleaning.html#th-down-data",
    "title": "Data Cleaning",
    "section": "",
    "text": "We start with the raw 4th down data from the nflverse package. The first six rows can be seen here.\n\n\n# A tibble: 6 × 383\n  play_id game_id      old_game_id home_team away_team season_type  week posteam\n    &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;  \n1       1 2022_01_BAL… 2022091107  NYJ       BAL       REG             1 &lt;NA&gt;   \n2      43 2022_01_BAL… 2022091107  NYJ       BAL       REG             1 NYJ    \n3      68 2022_01_BAL… 2022091107  NYJ       BAL       REG             1 NYJ    \n4      89 2022_01_BAL… 2022091107  NYJ       BAL       REG             1 NYJ    \n5     115 2022_01_BAL… 2022091107  NYJ       BAL       REG             1 NYJ    \n6     136 2022_01_BAL… 2022091107  NYJ       BAL       REG             1 NYJ    \n# ℹ 375 more variables: posteam_type &lt;chr&gt;, defteam &lt;chr&gt;, side_of_field &lt;chr&gt;,\n#   yardline_100 &lt;dbl&gt;, game_date &lt;chr&gt;, quarter_seconds_remaining &lt;dbl&gt;,\n#   half_seconds_remaining &lt;dbl&gt;, game_seconds_remaining &lt;dbl&gt;,\n#   game_half &lt;chr&gt;, quarter_end &lt;dbl&gt;, drive &lt;dbl&gt;, sp &lt;dbl&gt;, qtr &lt;dbl&gt;,\n#   down &lt;dbl&gt;, goal_to_go &lt;dbl&gt;, time &lt;chr&gt;, yrdln &lt;chr&gt;, ydstogo &lt;dbl&gt;,\n#   ydsnet &lt;dbl&gt;, desc &lt;chr&gt;, play_type &lt;chr&gt;, yards_gained &lt;dbl&gt;,\n#   shotgun &lt;dbl&gt;, no_huddle &lt;dbl&gt;, qb_dropback &lt;dbl&gt;, qb_kneel &lt;dbl&gt;, …\n\n\nThere are a large number of columns in this data, taken from the 2022 NFL season, we do not need all 383. The purpose of this data is to help determine how coaches today approach 4th down, a basic yet essential decision in the NFL. To do this we only need to look at these columns:\n\n\n# A tibble: 6 × 9\n  home_coach away_coach posteam_type ydstogo yardline_100 posteam go_boost    go\n  &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;\n1 Robert Sa… John Harb… home              15           64 NYJ       -3.45      0\n2 Robert Sa… John Harb… away               1           51 BAL        3.67      0\n3 Robert Sa… John Harb… home               9           82 NYJ       -2.07      0\n4 Robert Sa… John Harb… away               9           65 BAL       -1.01      0\n5 Robert Sa… John Harb… away               3            6 BAL        0.141     0\n6 Robert Sa… John Harb… home               1           66 NYJ        0.654     0\n# ℹ 1 more variable: epa &lt;dbl&gt;\n\n\nEach unit in this table is one 4th down decision. The variables include:\n\n\n\n\n\nVariable\nDefinition\n\n\n\n\nhome_coach\nHome Team Coach\n\n\naway_coach\nAway Team Coach\n\n\nposteam_type\nOffense Home or Away\n\n\nydstogo\nYards to Go\n\n\nyardline_100\nYardline Relative to End Zone\n\n\nposteam\nOffense Team\n\n\ngo_boost\nChange in Win Probability if Conversion Attempted\n\n\ngo\nConversion Attempted (T/F)\n\n\nepa\nEstimated Points Added as a Result of the Play\n\n\n\n\n\n\n\nMaking a table showing when coaches make the correct decisions on 4th down is essential in evaluating their decision making process. This is made easy by the inclusion of the go_boost variable, which tells us the change in win probability if the team decides to go for it.\n\n\n# A tibble: 6 × 5\n  coach          should_go shouldnt_go      EPA count\n  &lt;chr&gt;              &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt; &lt;int&gt;\n1 Andy Reid          0.216       0.982  0.0590    106\n2 Arthur Smith       0.333       0.985 -0.0540    114\n3 Bill Belichick     0.204       0.962 -0.221     128\n4 Brandon Staley     0.347       0.971 -0.00908   140\n5 Brian Daboll       0.361       0.949  0.159     139\n6 Dan Campbell       0.507       0.907 -0.00432   121\n\n\nThis data shows when coaches make the correct choice on 4th down, their average estimated points added on 4th downs throughout the season, and the number of 4th down decisions they had to make throughout the season. It shows the percent of times each coach makes the correct decision in two scenarios: when going for it would have a positive effect on their win probability and when going for it would have a negative effect on their win probability.\n\n\n\nOne of, if not the most important factor in making a decision on fourth down is the position your team is on the field. Looking at this more closely requires a table that shows coaches decisions based on where they are on the field and how many downs they need to gain to get a first down.\n\n\n`summarise()` has grouped output by 'yardline_100'. You can override using the\n`.groups` argument.\n\n\n# A tibble: 6 × 6\n# Groups:   yardline_100 [3]\n  yardline_100 ydstogo    go count go_boost increase_odds\n         &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt;         &lt;dbl&gt;\n1            1       1  80.5    41    7.06              1\n2            2       1  75       4    3.69              1\n3            2       2  40.7    27    2.89              1\n4            3       1  50       2    2.54              1\n5            3       2  16.7     6    0.995             1\n6            3       3  38.5    26    0.721             1\n\n\nThis table shows us the percentage of times a coach chose to go for it in the given situation. The first row, for example, shows that 80.5% of the time a coach decided to go for it when they were at 4th and 1 at the 1 yard line - they were 1 yard away from scoring. It also shows is the average increase in win probability if a coach were to go for it. For example, at 4th and 1 at the 1 yard line, going for it increases your win probability by an average of 7%, an incredibly large number."
  },
  {
    "objectID": "data_cleaning.html#text-data",
    "href": "data_cleaning.html#text-data",
    "title": "Data Cleaning",
    "section": "Text Data",
    "text": "Text Data\n\nimport praw\nfrom sklearn.feature_extraction.text import CountVectorizer\nimport numpy as np\n\nreddit = praw.Reddit(\n  client_id = \"29BtHHkcVmVjeZfAU5Mfbw\",\n  client_secret = \"m8eoqej8ylk3LLG-n6TE1irUHOtxGw\",\n  user_agent = \"TNS621\"\n)\n\n\nsubreddit = reddit.subreddit(\"nfl\")\nquery = \"4th down\"\n\ntop_posts = subreddit.search(query, limit=100)\ncorpus = []\n\nfor post in top_posts:\n    corpus.append(post.title)\n\nvectorizer=CountVectorizer()   \nXs = vectorizer.fit_transform(corpus)\n\ncol_names=vectorizer.get_feature_names_out()\nprint(\"col_names=\",col_names)\n\ncol_names= ['100' '106' '13' '14' '158' '16' '18' '19' '1991' '1st' '20' '2009'\n '2014' '2017' '25' '27' '29' '30' '302' '34' '3rd' '49ers' '4th' '51'\n '65' '74' '83' '90' '91' '92' 'aaron' 'about' 'according' 'actually'\n 'adam' 'adams' 'adamteicher' 'admitted' 'afc' 'after' 'ago' 'aidan' 'all'\n 'allen' 'allow' 'already' 'an' 'and' 'andy' 'angeles' 'another' 'antonio'\n 'are' 'as' 'asked' 'at' 'attempt' 'attempts' 'avatar' 'avoids' 'away'\n 'back' 'baker' 'bal' 'baldwin' 'ball' 'be' 'bears' 'became' 'become'\n 'before' 'being' 'belichick' 'ben' 'bengals' 'best' 'better' 'big'\n 'bills' 'booong' 'boos' 'bootleg' 'bot' 'bow' 'brady' 'brandon' 'breakup'\n 'brown' 'browns' 'bryant' 'bumped' 'burke' 'burton' 'by' 'byu' 'call'\n 'called' 'calls' 'came' 'can' 'cannot' 'card' 'career' 'carolina' 'carr'\n 'catch' 'cbs' 'cement' 'cementing' 'changes' 'chargers' 'chart' 'chi'\n 'chicago' 'chiefs' 'cin' 'clark' 'class' 'clinch' 'clock' 'clutch'\n 'coach' 'coaching' 'coleman' 'colliding' 'colt' 'colts' 'combined'\n 'coming' 'completed' 'completely' 'completions' 'conduct' 'confused'\n 'conversion' 'conversions' 'convert' 'converting' 'converts' 'convinced'\n 'cooking' 'couldn' 'cousins' 'cowboys' 'crazy' 'critical' 'crowd' 'dak'\n 'dallas' 'dalton' 'darnell' 'davante' 'davis' 'debut' 'decides'\n 'decision' 'deebo' 'deep' 'defense' 'defining' 'deflects' 'delay'\n 'denzel' 'deshone' 'desmond' 'despite' 'devonta' 'did' 'didn' 'different'\n 'divisional' 'doesn' 'doug' 'dov' 'down' 'downs' 'drops' 'dugger'\n 'during' 'eagles' 'earlier' 'earned' 'edelman' 'elam' 'eliassports' 'end'\n 'endzone' 'eric' 'espn' 'estimated' 'etienne' 'evans' 'even' 'ever'\n 'every' 'expletives' 'fail' 'failed' 'fake' 'fans' 'fell' 'fg' 'field'\n 'fields' 'final' 'find' 'finds' 'firing' 'first' 'foles' 'for' 'forces'\n 'forder' 'foul' 'fox' 'from' 'gabe' 'gained' 'gamble' 'game' 'gardner'\n 'gb' 'geno' 'get' 'gets' 'giants' 'give' 'giving' 'go' 'goal' 'god'\n 'godert' 'goes' 'goff' 'golden' 'gone' 'goodwin' 'got' 'grade' 'grier'\n 'ground' 'gutsy' 'had' 'handed' 'harbaugh' 'hard' 'hasn' 'have' 'hc' 'he'\n 'held' 'hell' 'helman' 'herbert' 'highlight' 'hill' 'him' 'himself' 'his'\n 'history' 'hit' 'hits' 'hold' 'hutchinson' 'if' 'image' 'imagine' 'in'\n 'incomplete' 'incredible' 'ind' 'intercepted' 'interference' 'into' 'is'\n 'it' 'jabrill' 'jackson' 'jags' 'jaguars' 'jamaal' 'jared' 'jets' 'jimmy'\n 'john' 'jones' 'josh' 'judon' 'julian' 'julio' 'just' 'justin' 'kaiir'\n 'kc' 'keenum' 'kelce' 'kick' 'kizer' 'kleiman' 'knocks' 'knows' 'kyle'\n 'kyler' 'la' 'lamar' 'lar' 'last' 'lattimore' 'lead' 'left' 'life'\n 'lions' 'longest' 'look' 'los' 'lost' 'lvi' 'mahomes' 'makes' 'marker'\n 'marshon' 'matt' 'matthew' 'may' 'mayfield' 'mccarthy' 'mccoy'\n 'mcdermott' 'mcvay' 'metcalf' 'miami' 'mike' 'min' 'minshew' 'minute'\n 'minutes' 'missed' 'month' 'murray' 'my' 'myles' 'ndamukong' 'never'\n 'nfl' 'nick' 'not' 'nothing' 'nowhere' 'oc' 'october' 'of' 'off'\n 'officials' 'okwara' 'on' 'one' 'open' 'or' 'original' 'out' 'outside'\n 'over' 'overtime' 'own' 'packers' 'panthers' 'pass' 'passer' 'pats'\n 'pederson' 'penalty' 'pepper' 'per' 'perfect' 'personal' 'pff' 'phi'\n 'pick' 'planet' 'play' 'playcalling' 'playoffs' 'plays' 'points'\n 'pressure' 'pressures' 'pretty' 'probability' 'provides' 'punt' 'qb'\n 'quarterback' 'quarters' 'raiders' 'rams' 'ran' 'rate' 'rating' 'ravens'\n 're' 'reception' 'recommendation' 'record' 'red' 'regular' 'reid'\n 'renfrow' 'returns' 'ridder' 'robinson' 'rodgers' 'rolls' 'romo' 'ronald'\n 'round' 'run' 'runs' 'rush' 'russell' 'sacks' 'sauce' 'savage' 'save'\n 'sb' 'scared' 'schefter' 'score' 'scores' 'sea' 'seahawks' 'sean'\n 'season' 'seasons' 'second' 'seconds' 'seen' 'set' 'sharp' 'short' 'shot'\n 'similar' 'since' 'sixes' 'smith' 'snapped' 'sneaks' 'someone'\n 'something' 'sound' 'south' 'sports' 'spurrier' 'staley' 'starter'\n 'stathead' 'steelers' 'stifles' 'still' 'stop' 'stopped' 'stops' 'strip'\n 'strongest' 'stuffed' 'suh' 'sun' 'sure' 'system' 'tackle' 'take' 'takes'\n 'tariq' 'tate' 'td' 'team' 'territory' 'that' 'the' 'their' 'they'\n 'thing' 'third' 'thirty' 'this' 'though' 'thought' 'throw' 'throwback'\n 'throwing' 'throws' 'thursday' 'time' 'timeouts' 'times' 'tipped' 'to'\n 'today' 'told' 'tom' 'tonight' 'top' 'total' 'touch' 'touchdown'\n 'touchdowns' 'touching' 'trade' 'travis' 'trey' 'tried' 'tua' 'turn'\n 'turnover' 'twice' 'twitter' 'tyreek' 'ugly' 'unless' 'unsportsmanlike'\n 'up' 've' 'victim' 'vs' 'ward' 'was' 'watch' 'weddle' 'went' 'were' 'wft'\n 'what' 'when' 'while' 'whose' 'wide' 'wild' 'wildcat' 'will' 'williams'\n 'wilson' 'win' 'winning' 'wisconsin' 'with' 'won' 'woolen' 'work' 'worst'\n 'yard' 'yards' 'yates' 'years' 'yes' 'yesterday' 'you' 'yours' 'zero'\n 'zone']"
  },
  {
    "objectID": "data_gathering.html",
    "href": "data_gathering.html",
    "title": "Data Gathering",
    "section": "",
    "text": "Data\nData to evaluate NFL decision making was gathered by using the nflreadr package. The creators of this package provide detailed instructions and examples on how to use and clean this data, which can be found at their website here.\nReddit data is accessed through their API, information on which can be found here. This is done using PRAW: the Python Reddit API Wrapper."
  },
  {
    "objectID": "data_cleaning.html#sentiment-analysis",
    "href": "data_cleaning.html#sentiment-analysis",
    "title": "Data Cleaning",
    "section": "",
    "text": "The NFL subreddit is a useful place to extract text data produced by fans and their reaction to these essential decisions. Like most jobs, the goal of an NFL head coach is not only to win games, but to keep their bosses happy. The size and outspoken nature of NFL fan bases can be a factor in the job security of these coaches, as if a coach loses the fans, their job gets a lot harder. This is where sentiment analysis comes in, as getting an idea of how fans feel about 4th down decisions by certain coaches may give us insights into how they are making their decisions, and whether or not the fans have any influence on the decision making process.\nThis allows us to get posts from the NFL subreddit using a search query of “4th down” and access the comments of those posts.\n\nsubreddit = reddit.subreddit(\"nfl\")\nquery = \"4th down\"\n\ntop_posts = subreddit.search(query, limit=100)\nurls = []\ncorpus = []\n\nfor post in top_posts:\n    urls.append(post.permalink)\n    \nurl = \"https://www.reddit.com\" + urls[0]\n\nsubmission = reddit.submission(url=url)\n\nsubmission.comments.replace_more(limit=0)\n\n[]\n\nfor top_level_comment in submission.comments:\n    corpus.append(top_level_comment.body)\n\nvectorizer=CountVectorizer()\nXs = vectorizer.fit_transform(corpus)\n\ncol_names=vectorizer.get_feature_names_out()\n\nThe overall sentiment from this brief analysis is a positive one, but the search terms need to be more specific to get any useful information out of this process.\n\nfrom nltk.sentiment import SentimentIntensityAnalyzer\n\noverall = []\nsia = SentimentIntensityAnalyzer()\n\nfor text in corpus:\n  score=sia.polarity_scores(text)\n  overall.append(score['compound'])\n\n\n\nsum(overall)/len(overall)\n\n0.1513641304347826"
  },
  {
    "objectID": "nflverse.html",
    "href": "nflverse.html",
    "title": "4th Down Data",
    "section": "",
    "text": "By Coach\nWe start with the raw 4th down data from the nflverse package. The first six rows and eight columns can be seen here.\n\n\n# A tibble: 6 × 383\n  play_id game_id      old_game_id home_team away_team season_type  week posteam\n    &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;  \n1       1 2014_01_BUF… 2014090702  CHI       BUF       REG             1 &lt;NA&gt;   \n2      36 2014_01_BUF… 2014090702  CHI       BUF       REG             1 BUF    \n3      51 2014_01_BUF… 2014090702  CHI       BUF       REG             1 BUF    \n4      72 2014_01_BUF… 2014090702  CHI       BUF       REG             1 BUF    \n5      93 2014_01_BUF… 2014090702  CHI       BUF       REG             1 BUF    \n6     115 2014_01_BUF… 2014090702  CHI       BUF       REG             1 BUF    \n# ℹ 375 more variables: posteam_type &lt;chr&gt;, defteam &lt;chr&gt;, side_of_field &lt;chr&gt;,\n#   yardline_100 &lt;dbl&gt;, game_date &lt;chr&gt;, quarter_seconds_remaining &lt;dbl&gt;,\n#   half_seconds_remaining &lt;dbl&gt;, game_seconds_remaining &lt;dbl&gt;,\n#   game_half &lt;chr&gt;, quarter_end &lt;dbl&gt;, drive &lt;dbl&gt;, sp &lt;dbl&gt;, qtr &lt;dbl&gt;,\n#   down &lt;dbl&gt;, goal_to_go &lt;dbl&gt;, time &lt;chr&gt;, yrdln &lt;chr&gt;, ydstogo &lt;dbl&gt;,\n#   ydsnet &lt;dbl&gt;, desc &lt;chr&gt;, play_type &lt;chr&gt;, yards_gained &lt;dbl&gt;,\n#   shotgun &lt;dbl&gt;, no_huddle &lt;dbl&gt;, qb_dropback &lt;dbl&gt;, qb_kneel &lt;dbl&gt;, …\n\n\nThere are a large number of columns in this data, taken from the 2022 NFL season, we do not need all 383. The purpose of this data is to help determine how coaches today approach 4th down, a basic yet essential decision in the NFL. To do this we only need to look at these columns:\n\n\n# A tibble: 6 × 10\n  season home_coach    away_coach   posteam posteam_type ydstogo yardline_100\n   &lt;int&gt; &lt;chr&gt;         &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;        &lt;dbl&gt;\n1   2014 Marc Trestman Doug Marrone BUF     away               6           76\n2   2014 Marc Trestman Doug Marrone CHI     home              17           65\n3   2014 Marc Trestman Doug Marrone BUF     away               4           44\n4   2014 Marc Trestman Doug Marrone BUF     away               6           32\n5   2014 Marc Trestman Doug Marrone CHI     home               5           40\n6   2014 Marc Trestman Doug Marrone BUF     away              18           48\n# ℹ 3 more variables: go_boost &lt;dbl&gt;, go &lt;dbl&gt;, epa &lt;dbl&gt;\n\n\nEach unit in this table is one 4th down decision. The variables include:\n\n\n\n\n\n\nDescription\nType\nDatatype\n\n\n\n\nseason\nSeason\nDiscrete Numeric\ninteger\n\n\nhome_coach\nHome Team Coach\nCategorical\ncharacter\n\n\naway_coach\nAway Team Coach\nCategorical\ncharacter\n\n\nposteam\nOffense Team\nCategorical\ncharacter\n\n\nposteam_type\nOffense Home or Away\nCategorical\ncharacter\n\n\nydstogo\nYards to Go\nDiscrete Numeric\nnumeric\n\n\nyardline_100\nYardline Relative to End Zone\nDiscrete Numeric\nnumeric\n\n\ngo_boost\nChange in Win Probability if Conversion Attempted\nContinuous\nnumeric\n\n\ngo\nConversion Attempted (T/F)\nCategorical\nnumeric\n\n\nepa\nEstimated Points Added as a Result of the Play\nContinuous\nnumeric\n\n\n\n\n\n\n\nMaking a table showing when coaches make the correct decisions on 4th down is essential in evaluating their decision making process. This is made easy by the inclusion of the go_boost variable, which tells us the change in win probability if the team decides to go for it.\n\n\n`summarise()` has grouped output by 'coach', 'posteam'. You can override using\nthe `.groups` argument.\n\n\n# A tibble: 6 × 7\n  coach     posteam season should_go shouldnt_go     EPA count\n  &lt;chr&gt;     &lt;chr&gt;    &lt;int&gt;     &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;\n1 Adam Gase MIA       2016     0.075       0.975 -0.278    119\n2 Adam Gase MIA       2017     0.375       0.890 -0.133    131\n3 Adam Gase MIA       2018     0.211       1     -0.0208   123\n4 Adam Gase NYJ       2019     0.34        0.976 -0.171    133\n5 Adam Gase NYJ       2020     0.237       0.942 -0.382    128\n6 Andy Reid KC        2014     0.191       0.984  0.0565   111\n\n\nThis data shows when coaches make the correct choice on 4th down, their average estimated points added on 4th downs throughout the season, and the number of 4th down decisions they had to make throughout the season. It shows the percent of times each coach makes the correct decision in two scenarios: when going for it would have a positive effect on their win probability and when going for it would have a negative effect on their win probability.\n\n\nBy Situation\nOne of, if not the most important factor in making a decision on fourth down is the position your team is on the field. Looking at this more closely requires a table that shows coaches decisions based on where they are on the field and how many downs they need to gain to get a first down.\n\n\n`summarise()` has grouped output by 'yardline_100'. You can override using the\n`.groups` argument.\n\n\n# A tibble: 6 × 7\n# Groups:   yardline_100 [3]\n  yardline_100 ydstogo actual_go expected_go count go_boost increase_odds\n         &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt;         &lt;dbl&gt;\n1            1       1     0.799       0.958   359    4.91              1\n2            2       1     0.710       0.903    31    4.47              1\n3            2       2     0.363       0.872   234    2.29              1\n4            3       1     0.825       0.95     40    6.12              1\n5            3       2     0.36        0.68     25    1.14              1\n6            3       3     0.2         0.637   215    0.728             1\n\n\nThis table shows us the percentage of times a coach chose to go for it in the given situation. The first row, for example, shows that 80% of the time a coach decided to go for it when they were at 4th and 1 at the 1 yard line - they were 1 yard away from scoring. It also shows is the average increase in win probability if a coach were to go for it. For example, at 4th and 1 at the 1 yard line, going for it increases your win probability by an average of 5%, an incredibly large number."
  },
  {
    "objectID": "nflverse.html#th-down-data",
    "href": "nflverse.html#th-down-data",
    "title": "4th Down Data",
    "section": "",
    "text": "We start with the raw 4th down data from the nflverse package. The first six rows and eight columns can be seen here.\n\n\n# A tibble: 6 × 383\n  play_id game_id      old_game_id home_team away_team season_type  week posteam\n    &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;  \n1       1 2022_01_BAL… 2022091107  NYJ       BAL       REG             1 &lt;NA&gt;   \n2      43 2022_01_BAL… 2022091107  NYJ       BAL       REG             1 NYJ    \n3      68 2022_01_BAL… 2022091107  NYJ       BAL       REG             1 NYJ    \n4      89 2022_01_BAL… 2022091107  NYJ       BAL       REG             1 NYJ    \n5     115 2022_01_BAL… 2022091107  NYJ       BAL       REG             1 NYJ    \n6     136 2022_01_BAL… 2022091107  NYJ       BAL       REG             1 NYJ    \n# ℹ 375 more variables: posteam_type &lt;chr&gt;, defteam &lt;chr&gt;, side_of_field &lt;chr&gt;,\n#   yardline_100 &lt;dbl&gt;, game_date &lt;chr&gt;, quarter_seconds_remaining &lt;dbl&gt;,\n#   half_seconds_remaining &lt;dbl&gt;, game_seconds_remaining &lt;dbl&gt;,\n#   game_half &lt;chr&gt;, quarter_end &lt;dbl&gt;, drive &lt;dbl&gt;, sp &lt;dbl&gt;, qtr &lt;dbl&gt;,\n#   down &lt;dbl&gt;, goal_to_go &lt;dbl&gt;, time &lt;chr&gt;, yrdln &lt;chr&gt;, ydstogo &lt;dbl&gt;,\n#   ydsnet &lt;dbl&gt;, desc &lt;chr&gt;, play_type &lt;chr&gt;, yards_gained &lt;dbl&gt;,\n#   shotgun &lt;dbl&gt;, no_huddle &lt;dbl&gt;, qb_dropback &lt;dbl&gt;, qb_kneel &lt;dbl&gt;, …\n\n\nThere are a large number of columns in this data, taken from the 2022 NFL season, we do not need all 383. The purpose of this data is to help determine how coaches today approach 4th down, a basic yet essential decision in the NFL. To do this we only need to look at these columns:\n\n\n# A tibble: 6 × 9\n  home_coach away_coach posteam_type ydstogo yardline_100 posteam go_boost    go\n  &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;\n1 Robert Sa… John Harb… home              15           64 NYJ       -3.45      0\n2 Robert Sa… John Harb… away               1           51 BAL        3.67      0\n3 Robert Sa… John Harb… home               9           82 NYJ       -2.07      0\n4 Robert Sa… John Harb… away               9           65 BAL       -1.01      0\n5 Robert Sa… John Harb… away               3            6 BAL        0.141     0\n6 Robert Sa… John Harb… home               1           66 NYJ        0.654     0\n# ℹ 1 more variable: epa &lt;dbl&gt;\n\n\nEach unit in this table is one 4th down decision. The variables include:\n\n\n\n\n\nVariable\nDefinition\n\n\n\n\nhome_coach\nHome Team Coach\n\n\naway_coach\nAway Team Coach\n\n\nposteam_type\nOffense Home or Away\n\n\nydstogo\nYards to Go\n\n\nyardline_100\nYardline Relative to End Zone\n\n\nposteam\nOffense Team\n\n\ngo_boost\nChange in Win Probability if Conversion Attempted\n\n\ngo\nConversion Attempted (T/F)\n\n\nepa\nEstimated Points Added as a Result of the Play\n\n\n\n\n\n\n\nMaking a table showing when coaches make the correct decisions on 4th down is essential in evaluating their decision making process. This is made easy by the inclusion of the go_boost variable, which tells us the change in win probability if the team decides to go for it.\n\n\n# A tibble: 6 × 5\n  coach          should_go shouldnt_go      EPA count\n  &lt;chr&gt;              &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt; &lt;int&gt;\n1 Andy Reid          0.216       0.982  0.0590    106\n2 Arthur Smith       0.333       0.985 -0.0540    114\n3 Bill Belichick     0.204       0.962 -0.221     128\n4 Brandon Staley     0.347       0.971 -0.00908   140\n5 Brian Daboll       0.361       0.949  0.159     139\n6 Dan Campbell       0.507       0.907 -0.00432   121\n\n\nThis data shows when coaches make the correct choice on 4th down, their average estimated points added on 4th downs throughout the season, and the number of 4th down decisions they had to make throughout the season. It shows the percent of times each coach makes the correct decision in two scenarios: when going for it would have a positive effect on their win probability and when going for it would have a negative effect on their win probability.\n\n\n\nOne of, if not the most important factor in making a decision on fourth down is the position your team is on the field. Looking at this more closely requires a table that shows coaches decisions based on where they are on the field and how many downs they need to gain to get a first down.\n\n\n`summarise()` has grouped output by 'yardline_100'. You can override using the\n`.groups` argument.\n\n\n# A tibble: 6 × 6\n# Groups:   yardline_100 [3]\n  yardline_100 ydstogo    go count go_boost increase_odds\n         &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt;         &lt;dbl&gt;\n1            1       1  80.5    41    7.06              1\n2            2       1  75       4    3.69              1\n3            2       2  40.7    27    2.89              1\n4            3       1  50       2    2.54              1\n5            3       2  16.7     6    0.995             1\n6            3       3  38.5    26    0.721             1\n\n\nThis table shows us the percentage of times a coach chose to go for it in the given situation. The first row, for example, shows that 80.5% of the time a coach decided to go for it when they were at 4th and 1 at the 1 yard line - they were 1 yard away from scoring. It also shows is the average increase in win probability if a coach were to go for it. For example, at 4th and 1 at the 1 yard line, going for it increases your win probability by an average of 7%, an incredibly large number."
  },
  {
    "objectID": "nflverse.html#sentiment-analysis",
    "href": "nflverse.html#sentiment-analysis",
    "title": "4th Down Data",
    "section": "",
    "text": "The NFL subreddit is a useful place to extract text data produced by fans and their reaction to these essential decisions. Like most jobs, the goal of an NFL head coach is not only to win games, but to keep their bosses happy. The size and outspoken nature of NFL fan bases can be a factor in the job security of these coaches, as if a coach loses the fans, their job gets a lot harder. This is where sentiment analysis comes in, as getting an idea of how fans feel about 4th down decisions by certain coaches may give us insights into how they are making their decisions, and whether or not the fans have any influence on the decision making process.\nThis allows us to get posts from the NFL subreddit using a search query of “4th down” and access the comments of those posts.\n\nsubreddit = reddit.subreddit(\"nfl\")\nquery = \"4th down\"\n\ntop_posts = subreddit.search(query, limit=100)\nurls = []\ncorpus = []\n\nfor post in top_posts:\n    urls.append(post.permalink)\n    \nurl = \"https://www.reddit.com\" + urls[0]\n\nsubmission = reddit.submission(url=url)\n\nsubmission.comments.replace_more(limit=0)\n\n[]\n\nfor top_level_comment in submission.comments:\n    corpus.append(top_level_comment.body)\n\nvectorizer=CountVectorizer()\nXs = vectorizer.fit_transform(corpus)\n\ncol_names=vectorizer.get_feature_names_out()\n\nThe overall sentiment from this brief analysis is a positive one, but the search terms need to be more specific to get any useful information out of this process.\n\nfrom nltk.sentiment import SentimentIntensityAnalyzer\n\noverall = []\nsia = SentimentIntensityAnalyzer()\n\nfor text in corpus:\n  score=sia.polarity_scores(text)\n  overall.append(score['compound'])\n\n\n\nsum(overall)/len(overall)\n\n0.14158709677419354"
  },
  {
    "objectID": "reddit.html",
    "href": "reddit.html",
    "title": "Text Data",
    "section": "",
    "text": "Sentiment Analysis\nThe NFL subreddit is a useful place to extract text data produced by fans and their reaction to these essential decisions. Like most jobs, the goal of an NFL head coach is not only to win games, but to keep their bosses happy. The size and outspoken nature of NFL fan bases can be a factor in the job security of these coaches, as if a coach loses the fans, their job gets a lot harder. This is where sentiment analysis comes in, as getting an idea of how fans feel about 4th down decisions by certain coaches may give us insights into how they are making their decisions, and whether or not the fans have any influence on the decision making process.\nThis allows us to get posts from the NFL subreddit using a search query of “4th down” and access the comments of those posts.\n\nsubreddit = reddit.subreddit(\"nfl\")\nquery = \"4th down\"\n\ntop_posts = subreddit.search(query, limit=100)\nurls = []\ncorpus = []\n\nfor post in top_posts:\n    urls.append(post.permalink)\n    \nurl = \"https://www.reddit.com\" + urls[0]\n\nsubmission = reddit.submission(url=url)\n\nsubmission.comments.replace_more(limit=0)\n\n[]\n\nfor top_level_comment in submission.comments:\n    corpus.append(top_level_comment.body)\n\nvectorizer=CountVectorizer()\nXs = vectorizer.fit_transform(corpus)\n\ncol_names=vectorizer.get_feature_names_out()\n\nThe overall sentiment from this brief analysis is a positive one, but the search terms need to be more specific to get any useful information out of this process.\n\nfrom nltk.sentiment import SentimentIntensityAnalyzer\n\noverall = []\nsia = SentimentIntensityAnalyzer()\n\nfor text in corpus:\n  score=sia.polarity_scores(text)\n  overall.append(score['compound'])\n\n\n\nsum(overall)/len(overall)\n\n0.14158709677419354"
  },
  {
    "objectID": "data_exploration2.html",
    "href": "data_exploration2.html",
    "title": "Effect on Coach Success",
    "section": "",
    "text": "As we saw in the last step of our EDA, coaches are consistently far too conservative when it comes to fourth down decisions. We are trying to figure out why this may be the case. Two possible reasons immediately come to mind:\n\n4th down decisions have less effect on the outcome of games than we think.\nCoaches who are more conservative will keep their jobs longer, as being aggressive (and failing) on fourth down could be generally frowned upon by the NFL community.\n\nLets explore the first reason. One simple measure of coach success season by season is winning percentage. To take a quick look this, we can look at how correct decision rate on 4th down compares to the winning percentage a coach had in that particular season. Alongside this process we will also look at the average EPA per play on 4th downs coaches had in go-for-it situations that season. EPA is a measure of success that stands for “Estimated Points Added” and it measures the estimated points a play will add to the total final score at the end of the game.\n\n\n\n\n\ncoach\nteam\nseason\ncorrect_rate\npct\nepa\n\n\n\n\nAdam Gase\nMIA\n2016\n0.075\n0.625\n-0.278\n\n\nAdam Gase\nMIA\n2017\n0.375\n0.375\n-0.133\n\n\nAdam Gase\nMIA\n2018\n0.211\n0.438\n-0.021\n\n\nAdam Gase\nNYJ\n2019\n0.340\n0.438\n-0.171\n\n\nAdam Gase\nNYJ\n2020\n0.237\n0.125\n-0.382\n\n\nAndy Reid\nKC\n2016\n0.269\n0.750\n0.230\n\n\nAndy Reid\nKC\n2017\n0.170\n0.625\n0.096\n\n\nAndy Reid\nKC\n2018\n0.422\n0.750\n0.353\n\n\nAndy Reid\nKC\n2019\n0.286\n0.750\n0.021\n\n\nAndy Reid\nKC\n2020\n0.360\n0.875\n0.097\n\n\n\n\n\n\n\nNow we have the winning percentage and epa alongside the correct decision rate on fourth down for every coach by season. Let’s take a closer look at this table and add averages for winning percentage, correct decision rate, and epa.\n\n\n\n\n\ncoach\nteam\nseason\ncorrect_rate\npct\nepa\nz_wins\nz_correct\nz_epa\nabove_mean_wins\nabove_mean_correct\nabove_mean_epa\n\n\n\n\nAdam Gase\nMIA\n2016\n0.075\n0.625\n-0.278\n0.657\n-2.428\n-1.450\n1\n0\n0\n\n\nAdam Gase\nMIA\n2017\n0.375\n0.375\n-0.133\n-0.653\n0.567\n-0.613\n0\n1\n0\n\n\nAdam Gase\nMIA\n2018\n0.211\n0.438\n-0.021\n-0.326\n-1.075\n0.032\n0\n0\n1\n\n\nAdam Gase\nNYJ\n2019\n0.340\n0.438\n-0.171\n-0.326\n0.218\n-0.837\n0\n1\n0\n\n\nAdam Gase\nNYJ\n2020\n0.237\n0.125\n-0.382\n-1.963\n-0.808\n-2.054\n0\n0\n0\n\n\nAndy Reid\nKC\n2016\n0.269\n0.750\n0.230\n1.312\n-0.489\n1.482\n1\n0\n1\n\n\nAndy Reid\nKC\n2017\n0.170\n0.625\n0.096\n0.657\n-1.481\n0.705\n1\n0\n1\n\n\nAndy Reid\nKC\n2018\n0.422\n0.750\n0.353\n1.312\n1.039\n2.189\n1\n1\n1\n\n\nAndy Reid\nKC\n2019\n0.286\n0.750\n0.021\n1.312\n-0.324\n0.274\n1\n0\n1\n\n\nAndy Reid\nKC\n2020\n0.360\n0.875\n0.097\n1.967\n0.417\n0.710\n1\n1\n1\n\n\n\n\n\n\n\nNow we can cross tabulate effectively.\n\n\n\n\n\n\n\n\n\n\n\nIt looks as if decision rate on 4th down has little effect on the win rate of coaches, which makes sense as when looking at plays across an entire game, 4th down plays make up a small percentage of those plays. It would be worth looking at how influential 4th down plays are on the result of each game compared to other types of plays, though.\nHaving a good correct 4th down decision does seem to have more of an effect on EPA, however. This makes sense as EPA in this case is estimated points added on 4th down, meaning this metric is directly measuring success on 4th down only, rather than success across an entire game. It is not surpising that having a good correct 4th down decision rate would lead to a more positive 4th down success metric than a whole game success metric.\nIt is an encouraging sign to see that making “correct” decisions on 4th down leads to more points on those 4th down plays. This means it would be useful to explore how 4th down plays contribute to a team’s final score compared to plays on other downs. This may give us a better idea as to how these 4th down decisions affect the success of coaches across the entire game, rather than simply on 4th down."
  },
  {
    "objectID": "data_exploration1.html",
    "href": "data_exploration1.html",
    "title": "4th Down Decisions",
    "section": "",
    "text": "We will initially explore the data in a similar manner to the method seen in David Romer’s paper (Romer 2006). In his evaluation of fourth down decisions, he followed a four step process. First, he estimated the value of kicking (not going for it). Second, he estimated the value of going for it. Third, he figured out which decision was better. Finally, he compared this to the actual decisions made by coaches.\nThanks again to the nflverse package, we already have completed steps one and two as we can simply use the go_boost variable to estimate the value of kicking or going for it on each fourth down. Step three was already completed in the cleaning process, as we already have a table that takes into account the fact that if go_boost is negative, then the offensive team should kick. If go_boost is positive, then they should go for it. We have all the information to evaluate theoretical decisions, now we must evaluate the actual decisions made by coaches.\n\n4th Down Statistics\nHow often do coaches make the correct decision on 4th down?\n\n\n\n\n\nWe can see a clear difference between these two plots when they are put on the same scale. When it would be a “correct” decision to kick rather than go for it (when win probability would go down if a conversion was attempted) coaches often make the correct decision. Every coach was correct in these situations at least 90% which makes sense because these decisions are often easy to make. They are not the borderline decisions that we can learn a lot about coaches from. For those we turn to the first graph, where we can clearly see that the decision on whether or not to go for it when doing so would increase your win probability is much more difficult, as only two coaches got this one right over 50% of the time. Let’s look at this decision more closely and see what turns coaches away from going for it even when they should be.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThe first graph is colored based on the proportion of plays in which a coach decides to go for it when doing so would have a positive impact on their win probability. The second graph is colored based on the proportion of plays in which going for it would have a positive impact on their win probability, regardless of whether or not a coach actually decided to go for it.\nThese graphs clearly show that coaches in the NFL are far too conservative. The only situation in which they consistently go for it is on 4th and 1 inside the 50. The data suggest that they should actually always go for it when there are less than 2 yards to go and almost always go for it within 5 yards. Coaches are consistently far too conservative in situations when it is clearly advantageous to attempt a 4th down conversion. Why might this be the case? Let’s perform some EDA to come up with some possible explanations.\n\n\n\n\n\nReferences\n\nRomer, David. 2006. “Do Firms Maximize? Evidence from Professional Football.” Journal of Political Economy 114 (2): 340–65. https://doi.org/10.1086/501171."
  },
  {
    "objectID": "data_cleaning2.html",
    "href": "data_cleaning2.html",
    "title": "Text Data",
    "section": "",
    "text": "Sentiment Analysis\nThe NFL subreddit is a useful place to extract text data produced by fans and their reaction to these essential decisions. Like most jobs, the goal of an NFL head coach is not only to win games, but to keep their bosses happy. The size and outspoken nature of NFL fan bases can be a factor in the job security of these coaches, as if a coach loses the fans, their job gets a lot harder. This is where sentiment analysis comes in, as getting an idea of how fans feel about 4th down decisions by certain coaches may give us insights into how they are making their decisions, and whether or not the fans have any influence on the decision making process.\nThis allows us to get posts from the NFL subreddit using a search query of “4th down” and access the comments of those posts.\n\nsubreddit = reddit.subreddit(\"nfl\")\nquery = \"4th down\"\n\ntop_posts = subreddit.search(query, limit=100)\nurls = []\ncorpus = []\n\nfor post in top_posts:\n    urls.append(post.permalink)\n    \nurl = \"https://www.reddit.com\" + urls[0]\n\nsubmission = reddit.submission(url=url)\n\nsubmission.comments.replace_more(limit=0)\n\n[]\n\nfor top_level_comment in submission.comments:\n    corpus.append(top_level_comment.body)\n\nvectorizer=CountVectorizer()\nXs = vectorizer.fit_transform(corpus)\n\ncol_names=vectorizer.get_feature_names_out()\n\nThe overall sentiment from this brief analysis is a positive one, but the search terms need to be more specific to get any useful information out of this process.\n\nfrom nltk.sentiment import SentimentIntensityAnalyzer\n\noverall = []\nsia = SentimentIntensityAnalyzer()\n\nfor text in corpus:\n  score=sia.polarity_scores(text)\n  overall.append(score['compound'])\n\n\n\nsum(overall)/len(overall)\n\n0.1478294736842105"
  },
  {
    "objectID": "data_cleaning1.html",
    "href": "data_cleaning1.html",
    "title": "4th Down Data",
    "section": "",
    "text": "By Coach\nWe start with the raw 4th down data from the nflverse package. The first six rows and eight columns can be seen here.\n\n\n# A tibble: 6 × 383\n  play_id game_id      old_game_id home_team away_team season_type  week posteam\n    &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;  \n1       1 2016_01_BUF… 2016091101  BAL       BUF       REG             1 &lt;NA&gt;   \n2      36 2016_01_BUF… 2016091101  BAL       BUF       REG             1 BAL    \n3      58 2016_01_BUF… 2016091101  BAL       BUF       REG             1 BAL    \n4      85 2016_01_BUF… 2016091101  BAL       BUF       REG             1 BAL    \n5     109 2016_01_BUF… 2016091101  BAL       BUF       REG             1 BAL    \n6     130 2016_01_BUF… 2016091101  BAL       BUF       REG             1 BAL    \n# ℹ 375 more variables: posteam_type &lt;chr&gt;, defteam &lt;chr&gt;, side_of_field &lt;chr&gt;,\n#   yardline_100 &lt;dbl&gt;, game_date &lt;chr&gt;, quarter_seconds_remaining &lt;dbl&gt;,\n#   half_seconds_remaining &lt;dbl&gt;, game_seconds_remaining &lt;dbl&gt;,\n#   game_half &lt;chr&gt;, quarter_end &lt;dbl&gt;, drive &lt;dbl&gt;, sp &lt;dbl&gt;, qtr &lt;dbl&gt;,\n#   down &lt;dbl&gt;, goal_to_go &lt;dbl&gt;, time &lt;chr&gt;, yrdln &lt;chr&gt;, ydstogo &lt;dbl&gt;,\n#   ydsnet &lt;dbl&gt;, desc &lt;chr&gt;, play_type &lt;chr&gt;, yards_gained &lt;dbl&gt;,\n#   shotgun &lt;dbl&gt;, no_huddle &lt;dbl&gt;, qb_dropback &lt;dbl&gt;, qb_kneel &lt;dbl&gt;, …\n\n\nThere are a large number of columns in this data, taken from the 2022 NFL season, we do not need all 383. The purpose of this data is to help determine how coaches today approach 4th down, a basic yet essential decision in the NFL. To do this we only need to look at these columns:\n\n\n# A tibble: 6 × 10\n  season home_coach    away_coach posteam posteam_type ydstogo yardline_100\n   &lt;int&gt; &lt;chr&gt;         &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;        &lt;dbl&gt;\n1   2016 John Harbaugh Rex Ryan   BAL     home               1           66\n2   2016 John Harbaugh Rex Ryan   BAL     home               6           71\n3   2016 John Harbaugh Rex Ryan   BUF     away              18           76\n4   2016 John Harbaugh Rex Ryan   BUF     away               6           43\n5   2016 John Harbaugh Rex Ryan   BUF     away              11           48\n6   2016 John Harbaugh Rex Ryan   BAL     home              15           32\n# ℹ 3 more variables: go_boost &lt;dbl&gt;, go &lt;dbl&gt;, epa &lt;dbl&gt;\n\n\nEach unit in this table is one 4th down decision. The variables include:\n\n\n\n\n\n\nDescription\nType\nDatatype\n\n\n\n\nseason\nSeason\nDiscrete Numeric\ninteger\n\n\nhome_coach\nHome Team Coach\nCategorical\ncharacter\n\n\naway_coach\nAway Team Coach\nCategorical\ncharacter\n\n\nposteam\nOffense Team\nCategorical\ncharacter\n\n\nposteam_type\nOffense Home or Away\nCategorical\ncharacter\n\n\nydstogo\nYards to Go\nDiscrete Numeric\nnumeric\n\n\nyardline_100\nYardline Relative to End Zone\nDiscrete Numeric\nnumeric\n\n\ngo_boost\nChange in Win Probability if Conversion Attempted\nContinuous\nnumeric\n\n\ngo\nConversion Attempted (T/F)\nCategorical\nnumeric\n\n\nepa\nEstimated Points Added as a Result of the Play\nContinuous\nnumeric\n\n\n\n\n\n\n\nMaking a table showing when coaches make the correct decisions on 4th down is essential in evaluating their decision making process. This is made easy by the inclusion of the go_boost variable, which tells us the change in win probability if the team decides to go for it.\n\n\n`summarise()` has grouped output by 'coach', 'posteam'. You can override using\nthe `.groups` argument.\n\n\n# A tibble: 6 × 7\n  coach     posteam season should_go shouldnt_go     EPA count\n  &lt;chr&gt;     &lt;chr&gt;    &lt;int&gt;     &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;\n1 Adam Gase MIA       2016     0.075       0.975 -0.278    119\n2 Adam Gase MIA       2017     0.375       0.890 -0.133    131\n3 Adam Gase MIA       2018     0.211       1     -0.0208   123\n4 Adam Gase NYJ       2019     0.34        0.976 -0.171    133\n5 Adam Gase NYJ       2020     0.237       0.942 -0.382    128\n6 Andy Reid KC        2016     0.269       1      0.230    134\n\n\nThis data shows when coaches make the correct choice on 4th down, their average estimated points added on 4th downs throughout the season, and the number of 4th down decisions they had to make throughout the season. It shows the percent of times each coach makes the correct decision in two scenarios: when going for it would have a positive effect on their win probability and when going for it would have a negative effect on their win probability.\n\n\nBy Situation\nOne of, if not the most important factor in making a decision on fourth down is the position your team is on the field. Looking at this more closely requires a table that shows coaches decisions based on where they are on the field and how many downs they need to gain to get a first down.\n\n\n`summarise()` has grouped output by 'yardline_100'. You can override using the\n`.groups` argument.\n\n\n# A tibble: 6 × 7\n# Groups:   yardline_100 [3]\n  yardline_100 ydstogo actual_go expected_go count go_boost increase_odds\n         &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt;         &lt;dbl&gt;\n1            1       1     0.820       0.956   295    4.96              1\n2            2       1     0.708       0.875    24    4.89              1\n3            2       2     0.409       0.852   176    2.38              1\n4            3       1     0.767       0.933    30    5.84              1\n5            3       2     0.45        0.75     20    1.62              1\n6            3       3     0.230       0.655   165    0.807             1\n\n\nThis table shows us the percentage of times a coach chose to go for it in the given situation. The first row, for example, shows that 80% of the time a coach decided to go for it when they were at 4th and 1 at the 1 yard line - they were 1 yard away from scoring. It also shows is the average increase in win probability if a coach were to go for it. For example, at 4th and 1 at the 1 yard line, going for it increases your win probability by an average of 5%, an incredibly large number."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "Thomas Sigall is a graduate student at Georgetown University currently pursuing a Masters of Science in Data Science and Analytics. He graduated from Villanova University in 2023 with a B.A. in Philosophy and Minors in Computer Science and Statistics. Originally from Redmond, Washington, he enjoys studying a wide range of topics, as evidenced by his diverse academic background. Outside of academics, he enjoys running and loves to follow sports."
  }
]